Update login for middleware (efficient)
