Improve role management for refactor (efficient)
