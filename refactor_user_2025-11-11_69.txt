Refactor user authentication for API (high-priority)
