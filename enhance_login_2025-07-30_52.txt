Enhance login for refactor (legacy)
