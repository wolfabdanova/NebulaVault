Develop error handling for middleware (legacy)
